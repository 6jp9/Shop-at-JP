<!DOCTYPE html>
{% extends 'user/base.html' %}
{% block body_block %}

<style>
/* ===============================
   Base Styling
   =============================== */
h1 {
  text-align: center;
  margin-bottom: 1rem;
}

.card {
  border-radius: 10px;
  overflow: hidden;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);
}

.card img {
  height: 180px;
  object-fit: cover;
}

.card-body {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

#nullDiv {
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  height: 60vh;
}

/* Filter container */
.filter-container {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px;
}

/* ===============================
   Responsive â€” Tablets (â‰¤768px)
   =============================== */
@media (max-width: 768px) {
  h1 {
    font-size: 1.4rem;
  }

  .filter-container {
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .card img {
    height: 150px;
  }

  .btn {
    font-size: 0.9rem;
  }
}

/* ===============================
   Responsive â€” Small Phones (â‰¤576px)
   =============================== */
@media (max-width: 576px) {
  h1 {
    font-size: 1.2rem;
  }

  .filter-container {
    flex-direction: column;
    display: flex;
    gap: 6px;
    width: 50%;
  }

  select.btn {
    width: 100%;
  }

  #btn {
    width: 100%;
    font-size: 0.85rem;
    padding: 6px 10px;
  }

  /* 2 cards per row */
  .row {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
  }

  .col-12.col-sm-6.col-md-4.col-lg-3 {
    flex: 0 0 calc(50% - 12px);
    max-width: calc(50% - 12px);
  }

  .card img {
    height: 140px;
  }

  .card-title {
    font-size: 0.95rem;
  }

}

/* ===============================
   Responsive â€” Extra Small Phones (â‰¤450px)
   =============================== */
@media (max-width: 450px) {
  .col-12.col-sm-6.col-md-4.col-lg-3 {
    flex: 0 0 100%;
    max-width: 100%;
  }

  .card img {
    height: 130px;
  }
  #FDD{
    width: 50%;
  }
  #FDD>select{
    display: inline;
  }
}
</style>

<div class="jumbotron py-4">
  <div class="container">
    <h1>Orders</h1>
    <form action="" method="GET" class="mb-3">
      <div class="filter-container">
        <select name="level" class="btn btn-light dropdown-toggle">
          <option value="All" {% if selected_level == 'All' %}selected{% endif %}>All</option>
          <option value="Ordered" {% if selected_level == 'Ordered' %}selected{% endif %}>Ordered</option>
          <option value="Canceled" {% if selected_level == 'Canceled' %}selected{% endif %}>Canceled</option>
        </select>
        <input type="submit" value="Filter" id="btn" class="btn btn-warning">
      </div>
    </form>
    <hr>

    {% if request.user.is_authenticated %}
      {% if request.user.is_superuser %}
        <div id="nullDiv">
          <div class="text-center">
            <h2 class="mb-3">Hello, {{ request.user.username }} ðŸ‘‘</h2>
            <p class="text-muted">You are logged in as a superuser.</p>
            <a class="btn btn-primary mt-3" href="/admin/">Go to Admin Dashboard</a>
          </div>
        </div>
      {% else %}
        {% if orders %}
          <div class="row g-4">
            {% for i in orders %}
              <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                <div class="card shadow-sm h-100">
                  <img src="{{ i.product.image.url }}" alt="cart" class="card-img-top">
                  <div class="card-body">
                    <h5 class="card-title text-truncate">{{ i.product.name|truncatechars:30 }}</h5>
                    <p class="fs-5 fw-semibold text-center mt-2">â‚¹ {{ i.price }}</p>
                    <p class="text-muted text-center mb-2">Status: <span class="fw-bold">{{ i.status }}</span></p>
                    <a href="{% url 'order_dtls' i.order_id %}" class="btn btn-outline-primary mt-auto">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-arrow-up-right" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                          d="M14 2.5a.5.5 0 0 0-.5-.5h-6a.5.5 0 0 0 0 1h4.793L2.146 13.146a.5.5 0 0 0 .708.708L13 3.707V8.5a.5.5 0 0 0 1 0z" />
                      </svg>
                      View Details
                    </a>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div id="nullDiv">
            <div>
              <h3>No Orders Found</h3>
              <a class="btn btn-info mt-3" href="/">Continue Shopping</a>
            </div>
          </div>
        {% endif %}
      {% endif %}
    {% else %}
      <div id="nullDiv">
        <div>
          <h3>Login to view</h3>
          <a href="{% url 'login' %}" class="btn btn-primary mt-3">Login</a>
        </div>
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
