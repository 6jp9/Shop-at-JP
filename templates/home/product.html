<!DOCTYPE html>
{% extends 'user/base.html' %}
{% block body_block %}

<div class="container mt-5">
    <div class="row align-items-center">

        <!-- Product Image -->
        <div class="col-md-5 text-center mb-4">
            <img src="{{ product.image.url }}" class="img-fluid rounded shadow" alt="{{ product.name }}">
        </div>

        <!-- Product Details -->
        <div class="col-md-7">
            <h2 class="fw-bold mb-3">{{ product.name }}</h2>

            <!-- Price -->
            <h4 class="text-success fw-bold mb-2">â‚¹.{{ product.price }}</h4>

            <!-- Stock -->
            <p class="text-muted small mb-3">In stock: {{ product.stock }}</p>

            <!-- Description -->
            <div class="bg-light p-3 rounded mb-4" id="product-description">
                <strong>Note:</strong> {{ product.description }}
            </div>

            <hr>

            {% if request.user.is_authenticated %}
                {% if request.user.is_superuser %}
            <div class="text-center">
            <h2 class="mb-3">Hello, {{ request.user.username }} ðŸ‘‘</h2>
            <p class="text-muted">You are logged in as a superuser.</p>
            </div>

                {% else %}
                <!-- Add to Cart Form -->
                 <div >
                    
                <form method="post" action="/cart/add/{{ product.product_id }}/" class="w-75" style="margin-bottom: 5px;">
                {% csrf_token %}
                <div class="input-group">
                <input type="number" 
                name="quantity" 
                value="1" 
                min="1" 
                max="{{ product.stock }}" 
                class="form-control" 
                style="max-width: 100px;text-align: center;">
                <button type="submit" class="btn btn-warning flex-fill">
                <i class="bi bi-cart-plus"></i> Add to Cart
                </button>
                </div>
                </form>

                <!-- Show In-Cart Badge if product already in cart -->
                {% if in_cart %}
                <a class="btn btn-primary w-75" href="\cart/" style="margin-bottom: 5px;">In Cart: {{ quantity }}</a>

                <a class="btn btn-success w-75" href="\buyitem/{{ cart_id }}">
                <i class="bi bi-bag-check"></i> Buy Now
                </a></div>
                {% endif %}
                {% endif %}
                

<!-- Buy Now Button -->
            {% else %}
                <!-- If not logged in -->
                <p class="text-danger mt-3">Please login to place an order.</p>
                <a class="btn btn-primary" href="{% url 'login' %}">
                    <i class="bi bi-box-arrow-in-right"></i> Login
                </a>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}
